"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[371],{9030:function(e,t,n){n.d(t,{Bs:function(){return o},Iq:function(){return a},Q7:function(){return i},TQ:function(){return d},dJ:function(){return s},j2:function(){return r},o3:function(){return c}});var r=function(e,t){return t[0]._id===e._id?t[1].name:t[0].name},i=function(e,t){return t[0]._id===e._id?t[1]:t[0]},s=function(e,t){return t[0]._id===e._id?t[1].pic:t[0].pic},o=function(e,t,n,r){return n<e.length-1&&(e[n+1].sender._id!==t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id!==r},a=function(e,t,n){return t===e.length-1&&e[e.length-1].sender._id!==n&&e[e.length-1].sender._id},c=function(e,t,n,r){return n<e.length-1&&e[n+1].sender._id===t.sender._id&&e[n].sender._id!==r?33:n<e.length-1&&e[n+1].sender._id!==t.sender._id&&e[n].sender._id!==r||n===e.length-1&&e[n].sender._id!==r?0:"auto"},d=function(e,t,n,r){return n<e.length-1&&(e[n+1].sender._id===t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id===r}},3118:function(e,t,n){n.d(t,{I8:function(){return a},tO:function(){return c}});var r=n(2426),i=n(329),s=n(4453),o=(0,r.ZF)({apiKey:"AIzaSyC85qBd04aedB2d_8ltfKEGV6hQhW8qslw",authDomain:"chatdapp-maern.firebaseapp.com",databaseURL:"https://chatdapp-maern-default-rtdb.firebaseio.com",projectId:"chatdapp-maern",storageBucket:"chatdapp-maern.appspot.com",messagingSenderId:"322704650394",appId:"1:322704650394:web:161bcb1828c1a572faef23"}),a=(0,i.v0)(o),c=(0,s.cF)(o)},2371:function(e,t,n){n.r(t),n.d(t,{default:function(){return Fe}});var r,i,s=n(885),o=n(8735),a=n(2791),c=n(8227),d=n(1052),l=n(2982),u=n(5861),h=n(7757),x=n.n(h),p=n(2908),f=n(4569),g=n.n(f),m=n(4453),j=n(632),b=n(3118),v=n(7111),w=n.n(v),C=n(5272),k=n(7231),S=n(2504),y=n(6866),F=n(8473),I=n(9576),R=n(4304),z=n(6023),N=n(9271),Z=n(9030),_=n(5223),A=n(6988),M=n(184),P=function(e){var t=e.user,n=e.children,r=(0,_.qY)(),i=r.isOpen,s=r.onOpen,a=r.onClose;return(0,M.jsxs)(o.xu,{children:[n?(0,M.jsx)(o.xv,{fontFamily:"Nunito",p:2,fontSize:18,onClick:s,children:n}):(0,M.jsx)(o.xv,{fontFamily:"Nunito",p:5,fontSize:22,onClick:s,children:"View Profile"}),(0,M.jsxs)(A.u_,{size:"3xl",isOpen:i,onClose:a,isCentered:!0,motionPreset:"slideInBottom",children:[(0,M.jsx)(A.ZA,{bg:"none",backdropFilter:"auto",backdropBlur:"5px"}),(0,M.jsxs)(A.hz,{minHeight:"450px",children:[(0,M.jsx)(A.xB,{fontSize:"40px",fontFamily:"Nunito",d:"flex",justifyContent:"center",children:t.name}),(0,M.jsx)(A.ol,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsx)(A.fe,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:(0,M.jsx)(y.qE,{boxSize:"250px",src:t.pic,name:t.name})}),(0,M.jsx)(A.mz,{d:"flex",alignItems:"center",justifyContent:"center",children:(0,M.jsxs)(o.xv,{fontSize:{base:"28px",md:"30px"},fontFamily:"Nunito",children:["Email: ",t.email]})})]})]})]})},B=n(3393),L=n(5798),O=n(2213),G=function(e){var t=e.user,n=e.handleFunction;return(0,M.jsxs)(o.xu,{px:2,py:1,borderRadius:"3xl",m:1,mb:2,fontSize:12,backgroundColor:"#805ad5",color:"white",cursor:"pointer",onClick:n,children:[t.name,(0,M.jsx)(C.Tw,{pl:1})]})},E=function(e){var t=e.user,n=e.handleFunction,r=(0,c.If)().colorMode;return(0,M.jsxs)(o.xu,{onClick:n,cursor:"pointer",w:"100%",d:"flex",alignItems:"center",px:3,py:2,mb:2,borderRadius:"xl",boxShadow:"inner",className:"transition-all duration-1000 ease-in-out",bg:"dark"===r?"#232b38":"#E8E8E8",_hover:{backgroundColor:"#38B2AC",color:"white",boxShadow:"md"},children:[(0,M.jsx)(y.qE,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),(0,M.jsxs)(o.xu,{children:[(0,M.jsx)(o.xv,{fontFamily:"Nunito",children:t.name}),(0,M.jsxs)(o.xv,{fontFamily:"Nunito",fontSize:"xs",children:[(0,M.jsx)("b",{children:"Email : "}),t.email]})]})]})},D=function(e){var t=e.fetchMessages,n=e.fetchAgain,r=e.setFetchAgain,i=(0,_.qY)(),c=i.isOpen,l=i.onOpen,h=i.onClose,f=(0,a.useState)(),m=(0,s.Z)(f,2),j=m[0],b=m[1],v=(0,a.useState)(""),w=(0,s.Z)(v,2),C=w[0],k=w[1],y=(0,a.useState)([]),F=(0,s.Z)(y,2),I=F[0],R=F[1],z=(0,a.useState)(!1),N=(0,s.Z)(z,2),Z=N[0],P=N[1],D=(0,a.useState)(!1),H=(0,s.Z)(D,2),q=H[0],V=H[1],U=(0,a.useState)(!1),T=(0,s.Z)(U,2),W=(T[0],T[1],(0,a.useState)()),Y=(0,s.Z)(W,2),J=Y[0],K=Y[1],Q=(0,p.pm)(),$=(0,d.g)(),X=$.selectedChat,ee=$.setSelectedChat,te=$.user,ne=function(){var e=(0,u.Z)(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,P(!0),n={headers:{Authorization:"Bearer ".concat(te.token)}},e.next=8,g().get("/api/user?search=".concat(C),n);case 8:r=e.sent,i=r.data,console.log(i),P(!1),R(i),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),Q({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),P(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,u.Z)(x().mark((function e(){var t,i,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,V(!0),t={headers:{Authorization:"Bearer ".concat(te.token)}},e.next=7,g().put("/api/chat/rename",{chatId:X._id,chatName:j,pic:J},t);case 7:i=e.sent,s=i.data,console.log(s._id),ee(s),r(!n),V(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),Q({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),V(!1);case 19:b("");case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,u.Z)(x().mark((function e(t){var i,s,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!X.users.find((function(e){return e._id===t._id}))){e.next=3;break}return Q({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(X.groupAdmin._id===te._id){e.next=6;break}return Q({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,P(!0),i={headers:{Authorization:"Bearer ".concat(te.token)}},e.next=11,g().put("/api/chat/groupadd",{chatId:X._id,userId:t._id},i);case 11:s=e.sent,o=s.data,ee(o),r(!n),P(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),Q({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),P(!1);case 22:b("");case 23:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,u.Z)(x().mark((function e(i){var s,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X.groupAdmin._id===te._id||i._id===te._id){e.next=3;break}return Q({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,P(!0),s={headers:{Authorization:"Bearer ".concat(te.token)}},e.next=8,g().put("/api/chat/groupremove",{chatId:X._id,userId:i._id},s);case 8:o=e.sent,a=o.data,i._id===te._id?ee():ee(a),r(!n),t(),P(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),Q({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),P(!1);case 20:b("");case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(o.xv,{fontFamily:"Nunito",p:5,fontSize:22,onClick:l,children:"Update Group"}),(0,M.jsxs)(A.u_,{size:"3xl",onClose:h,isOpen:c,isCentered:!0,motionPreset:"slideInBottom",children:[(0,M.jsx)(A.ZA,{bg:"none",backdropFilter:"auto",backdropBlur:"5px"}),(0,M.jsxs)(A.hz,{minHeight:"450px",children:[(0,M.jsx)(A.xB,{fontSize:"35px",fontFamily:"Nunito",d:"flex",justifyContent:"center",children:X.chatName}),(0,M.jsx)(A.ol,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsxs)(A.fe,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"center",children:[(0,M.jsx)(o.xu,{w:"100%",d:"flex",flexWrap:"wrap",pb:3,children:X.users.map((function(e){return(0,M.jsx)(G,{user:e,handleFunction:function(){return se(e)}},e._id)}))}),(0,M.jsxs)(B.NI,{d:"flex",children:[(0,M.jsx)(L.II,{placeholder:"Group Name",mb:3,value:j,onChange:function(e){return b(e.target.value)}}),(0,M.jsx)(S.zx,{variant:"solid",colorScheme:"teal",ml:1,isLoading:q,onClick:re,children:"Update"})]}),(0,M.jsx)(B.NI,{children:(0,M.jsx)(L.II,{type:"file",p:1.5,accept:"image/*",onChange:function(e){return function(e){if(e.type.match("image.*")){var t=new FileReader;t.addEventListener("load",(function(){K(t.result)}),!1),e&&t.readAsDataURL(e)}else alert("Please select image only.")}(e.target.files[0])}})}),(0,M.jsx)(B.NI,{children:(0,M.jsx)(L.II,{placeholder:"Add User to group",mb:1,onChange:function(e){return ne(e.target.value)}})}),Z?(0,M.jsx)(O.$,{size:"3xl"}):null===I||void 0===I?void 0:I.map((function(e){return(0,M.jsx)(E,{user:e,handleFunction:function(){return ie(e)}},e._id)}))]}),(0,M.jsx)(A.mz,{children:(0,M.jsx)(S.zx,{onClick:function(){return se(te)},colorScheme:"red",children:"Leave Group"})})]})]})]})},H=(n(1724),function(e){var t=e.colorMode,n=e.setSelectedChat,r=e.message,i=e.user,s=e.fetchMessages,a=e.deleteChat,c=e.fetchAgain,d=e.setFetchAgain,l=e.selectedChat,u=e.isPreview,h=e.setPic,x=(e.setAudio,e.setVideo),p=e.setFile,f=e.setGif,g=(0,N.k6)();return(0,M.jsx)(o.xv,{fontSize:{base:"28px",xl:"30px"},fontFamily:"Nunito",pb:3,px:2,w:"100%",d:"flex",alignItems:"center",bg:"dark"===t?"#2d3748":"white",children:u?(0,M.jsx)(k.Rg,{in:u,offsetY:"2000px",children:(0,M.jsxs)(o.xu,{d:"flex",children:[(0,M.jsx)(S.hU,{icon:(0,M.jsx)(I.Z,{}),onClick:function(){h(""),x(""),p(""),f("")},"aria-label":"back",variant:"",isRound:!0}),(0,M.jsx)(o.xv,{fontFamily:"Nunito",ml:3,children:"Preview"})]})}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(S.hU,{d:{base:"flex",xl:"none"},icon:(0,M.jsx)(C.Rp,{}),onClick:function(){n(),g.push("/@")},"aria-label":"back",fontSize:"2xl",variant:"",isRound:!0}),r&&(0,M.jsxs)(M.Fragment,{children:[l.isGroupChat?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(y.qE,{name:l.chatName,src:l.pic,ml:{base:3,xl:0}}),(0,M.jsx)(o.xu,{children:(0,M.jsx)(o.xv,{ml:2,textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"fit-content",overflow:"hidden",fontFamily:"Nunito",children:l.chatName})})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(y.qE,{name:(0,Z.j2)(i,l.users),src:(0,Z.dJ)(i,l.users),ml:{base:3,xl:0}}),(0,M.jsx)(o.xv,{ml:2,textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"fit-content",fontFamily:"Nunito",overflow:"hidden",children:(0,Z.j2)(i,l.users)})]}),(0,M.jsxs)(o.xu,{marginLeft:"auto",d:"flex",children:[(0,M.jsx)(S.hU,{icon:(0,M.jsx)(R.Z,{}),onClick:function(){return s()},"aria-label":"refresh",variant:"",isRound:!0}),(0,M.jsxs)(F.v2,{children:[(0,M.jsx)(F.j2,{as:S.hU,ml:2,variant:"",isRound:!0,children:(0,M.jsx)(z.Z,{})}),(0,M.jsxs)(F.qy,{borderColor:"#d3d3d300",borderRadius:"33px",boxShadow:"2xl",children:[(0,M.jsx)(F.sN,{borderRadius:"24px 24px 0 0",children:(0,M.jsxs)(o.xv,{p:5,fontSize:22,onClick:function(){return a()},fontFamily:"Nunito",children:["Delete ",l.isGroupChat?"Group":"Chat"]})}),(0,M.jsx)(F.R,{}),l.isGroupChat?(0,M.jsx)(F.sN,{borderRadius:"0 0 24px 24px",children:(0,M.jsx)(D,{fetchMessages:s,fetchAgain:c,setFetchAgain:d})}):(0,M.jsx)(F.sN,{borderRadius:"0 0 24px 24px",children:(0,M.jsx)(P,{user:(0,Z.Q7)(i,l.users),children:null})})]})]})]})]})]})})}),q=n(2824),V=n(6632),U=n.n(V),T=n(4174),W=n.n(T),Y=n(4814),J=n(3719),K=function(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"",children:(0,M.jsx)("path",{fill:"currentColor",d:"M1.816 15.556v.002c0 1.502.584 2.912 1.646 3.972s2.472 1.647 3.974 1.647a5.58 5.58 0 0 0 3.972-1.645l9.547-9.548c.769-.768 1.147-1.767 1.058-2.817-.079-.968-.548-1.927-1.319-2.698-1.594-1.592-4.068-1.711-5.517-.262l-7.916 7.915c-.881.881-.792 2.25.214 3.261.959.958 2.423 1.053 3.263.215l5.511-5.512c.28-.28.267-.722.053-.936l-.244-.244c-.191-.191-.567-.349-.957.04l-5.506 5.506c-.18.18-.635.127-.976-.214-.098-.097-.576-.613-.213-.973l7.915-7.917c.818-.817 2.267-.699 3.23.262.5.501.802 1.1.849 1.685.051.573-.156 1.111-.589 1.543l-9.547 9.549a3.97 3.97 0 0 1-2.829 1.171 3.975 3.975 0 0 1-2.83-1.173 3.973 3.973 0 0 1-1.172-2.828c0-1.071.415-2.076 1.172-2.83l7.209-7.211c.157-.157.264-.579.028-.814L11.5 4.36a.572.572 0 0 0-.834.018l-7.205 7.207a5.577 5.577 0 0 0-1.645 3.971z"})})},Q=function(e){var t=e.showPicker,n=e.showGifPicker,r=e.colorMode,i=e.setShowGifPicker,s=e.postDetails,a=e.postVideo,c=e.postFile;return(0,M.jsx)(M.Fragment,{children:t?!n&&(0,M.jsx)(Y.Z,{style:{marginRight:7,marginLeft:-15,color:"dark"===r?"#898787":"#707070"},onClick:function(){return i(!0)},children:(0,M.jsx)(J.Z,{})}):(0,M.jsxs)(F.v2,{children:[(0,M.jsx)(F.j2,{as:Y.Z,style:{marginRight:7,marginLeft:-15,color:"dark"===r?"#898787":"#707070"},children:(0,M.jsx)(K,{})}),(0,M.jsxs)(F.qy,{borderColor:"#d3d3d300",borderRadius:"33px",boxShadow:"2xl",children:[(0,M.jsx)(F.sN,{borderRadius:"24px 24px 0 0",children:(0,M.jsxs)("label",{htmlFor:"icon-button-file",children:[(0,M.jsx)("input",{id:"icon-button-file",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){return s(e.target.files[0])}}),(0,M.jsx)(o.xv,{p:3,fontSize:20,children:"Attach Image"})]})}),(0,M.jsx)(F.R,{}),(0,M.jsx)(F.sN,{children:(0,M.jsxs)("label",{htmlFor:"contained-button",children:[(0,M.jsx)("input",{id:"contained-button",type:"file",accept:"video/*",style:{display:"none"},onChange:function(e){return a(e.target.files[0])}}),(0,M.jsx)(o.xv,{p:3,fontSize:20,children:"Attach Video"})]})}),(0,M.jsx)(F.R,{}),(0,M.jsx)(F.sN,{borderRadius:"0 0 24px 24px",d:"flex",children:(0,M.jsxs)("label",{htmlFor:"contained",children:[(0,M.jsx)("input",{id:"contained",type:"file",accept:"file/*",style:{display:"none"},onChange:function(e){return c(e.target.files[0])}}),(0,M.jsx)(o.xv,{p:3,fontSize:20,children:"Attach File"})]})})]})]})})},$=n(3779),X=n(9387),ee=n(2274),te=function(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"",children:(0,M.jsx)("path",{fill:"currentColor",d:"M1.101 21.757 23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"})})},ne=function(e){var t=e.newMessage,n=e.pic,r=e.audio,i=e.gif,s=e.video,o=e.colorMode,a=e.sendMessageButton,c=e.picLoading,d=e.audioLoading,l=e.videoLoading,u=e.fileLoading,h=e.setIsAudioRecording,x=e.isRecording,p=e.onStop,f=e.isAudioRecording,g=e.setIsRecording;return g(!0===f?$.e.START:$.e.STOP),(0,M.jsx)(M.Fragment,{children:t&&""!==t.trim()||n||r||i||s?(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(Y.Z,{style:{marginLeft:5,color:"dark"===o?"#898787":"#707070"},onClick:a,children:(0,M.jsx)(te,{})})}):c||d||l||u?(0,M.jsx)(Y.Z,{disableRipple:!0,style:{marginLeft:7,color:"dark"===o?"#898787":"#707070"},children:(0,M.jsx)(O.$,{})}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Y.Z,{style:{marginLeft:5,marginRight:-10,color:"dark"===o?"#898787":"#707070"},onClick:function(){return h((function(e){return!e}))},children:f?(0,M.jsx)(X.Z,{}):(0,M.jsx)(ee.Z,{})}),(0,M.jsx)($.Z,{state:x,onStop:function(e){return p(e)},canvasWidth:"0px",canvasHeight:"0px",type:"audio/mp3"})]})})},re=function(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"ekdr8vow dhq51u3o",children:(0,M.jsx)("path",{fill:"currentColor",d:"M9.153 11.603c.795 0 1.439-.879 1.439-1.962s-.644-1.962-1.439-1.962-1.439.879-1.439 1.962.644 1.962 1.439 1.962zm-3.204 1.362c-.026-.307-.131 5.218 6.063 5.551 6.066-.25 6.066-5.551 6.066-5.551-6.078 1.416-12.129 0-12.129 0zm11.363 1.108s-.669 1.959-5.051 1.959c-3.505 0-5.388-1.164-5.607-1.959 0 0 5.912 1.055 10.658 0zM11.804 1.011C5.609 1.011.978 6.033.978 12.228s4.826 10.761 11.021 10.761S23.02 18.423 23.02 12.228c.001-6.195-5.021-11.217-11.216-11.217zM12 21.354c-5.273 0-9.381-3.886-9.381-9.159s3.942-9.548 9.215-9.548 9.548 4.275 9.548 9.548c-.001 5.272-4.109 9.159-9.382 9.159zm3.108-9.751c.795 0 1.439-.879 1.439-1.962s-.644-1.962-1.439-1.962-1.439.879-1.439 1.962.644 1.962 1.439 1.962z"})})},ie=function(e){var t=e.showGifPicker,n=e.colorMode,r=e.setShowGifPicker,i=e.setShowPicker,s=e.showPicker;return(0,M.jsx)(M.Fragment,{children:t?(0,M.jsx)(Y.Z,{style:{marginRight:7,color:"dark"===n?"#898787":"#707070"},onClick:function(){return r((function(e){return!e}))},children:(0,M.jsx)(I.Z,{})}):s?(0,M.jsx)(Y.Z,{style:{marginRight:7,color:"dark"===n?"#898787":"#707070"},onClick:function(){return i((function(e){return!e}))},children:(0,M.jsx)(I.Z,{})}):(0,M.jsx)(Y.Z,{style:{marginRight:7,color:"dark"===n?"#898787":"#707070"},onClick:function(){return i((function(e){return!e}))},children:(0,M.jsx)(re,{})})})},se=n(1748),oe=function(e){var t=e.newMessage,n=e.typingHandler,r=e.placeholder,i=(0,c.If)().colorMode;return(0,M.jsx)(se.Z,{minRows:1,maxRows:4,style:{width:"100%",minHeight:"47px",maxHeight:"148px",border:"none",fontSize:20,borderRadius:"10px",outline:"none",background:"dark"===i?"#232b38":"#f0f2f5",padding:"8px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"},placeholder:r,value:t,onChange:function(e){return n(e.target.value)}})},ae=n(7772),ce=function(e){var t=e.sendMessage,n=e.setShowPicker,r=e.sendMessageButton,i=e.newMessage,s=e.typingHandler,a=e.pic,d=e.postDetails,l=e.picLoading,u=(e.setPic,e.file),h=(e.setFile,e.postAudio,e.postFile),x=e.audio,p=e.audioLoading,f=e.setAudio,g=e.showPicker,m=e.setShowGifPicker,j=e.showGifPicker,b=e.gif,v=(e.setGif,e.postVideo),w=e.videoLoading,C=e.video,k=(e.setVideo,e.onEmojiClick),S=e.fileLoading,y=e.setGifHandler,F=e.isRecording,I=e.setIsRecording,R=e.isAudioRecording,z=e.setIsAudioRecording,N=(0,c.If)().colorMode,Z=a||C||u||b,_=function(e){console.log("audioData",e),f(e.url)};return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.xu,{overflow:"scroll",children:[a&&!g?(0,M.jsx)(o.xu,{alignItems:"center",d:"flex",flexDir:"column",children:(0,M.jsx)(W(),{showRotation:!0,showZoom:!0,showDownload:!0,src:a,alt:"",className:"image2"})}):(0,M.jsx)(M.Fragment,{}),b&&!g?(0,M.jsx)(o.xu,{alignItems:"center",d:"flex",flexDir:"column",children:(0,M.jsx)(W(),{showRotation:!0,showZoom:!0,src:b,alt:"",className:"image2"})}):(0,M.jsx)(M.Fragment,{}),C&&!g?(0,M.jsx)(o.xu,{alignItems:"center",d:"flex",flexDir:"column",children:(0,M.jsx)("video",{src:C,controls:!0,className:"video"})}):(0,M.jsx)(M.Fragment,{}),u&&!g?(0,M.jsx)(o.xu,{alignItems:"center",d:"flex",flexDir:"column",children:(0,M.jsx)("iframe",{src:u,className:"file"})}):(0,M.jsx)(M.Fragment,{})]}),g&&!j?(0,M.jsx)(q.h,{emojiVersion:14,emojiSize:45,onEmojiClick:function(e){return k(e)},set:"native",tabsVariant:"fullWidth",styles:{backgroundColor:"dark"===N?"#2d3748":"#fff",indicatorColor:"dark"!==N?"#232b38":"#f9f2f5",fontColor:"lightgrey",searchBackgroundColor:"dark"===N?"#232b38":"#f9f2f5",tabsFontColor:"dark"!==N?"#232b38":"#f9f9f9",searchFontColor:"lightgrey",skinTonePickerBackgroundColor:"dark"===N?"#232b38":"#f9f2f5"},mode:"dark"===N?"dark":"light"}):(0,M.jsx)(M.Fragment,{}),j&&(0,M.jsx)(U(),{apiKey:"P9bkVJ0Z7fcRkW7dRCrZz7BgNsrtc30f",onSelected:function(e){return y(e.downsized.url)},width:"100%"}),Z?(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(B.NI,{isRequired:!0,w:"100%",fontFamily:"Nunito",d:"flex",justifyContent:"center",alignItems:"center",px:20,mt:"auto",children:[(0,M.jsx)(ie,{showGifPicker:j,colorMode:N,setShowGifPicker:m,setShowPicker:n,showPicker:g}),(0,M.jsx)(oe,{newMessage:i,typingHandler:s,placeholder:"Add a caption..."}),(0,M.jsx)(ne,{newMessage:i,pic:a,audio:x,gif:b,video:C,colorMode:N,sendMessageButton:r,picLoading:l,audioLoading:p,videoLoading:w,fileLoading:S,setIsAudioRecording:z,isRecording:F,onStop:_,isAudioRecording:R,setIsRecording:I})]})}):(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(B.NI,{onKeyDown:t,isRequired:!0,w:"100%",fontFamily:"Nunito",d:"flex",justifyContent:"center",alignItems:"center",pt:3,px:2,children:[x?(0,M.jsx)(ae.Z,{src:x,style:{backgroundColor:"dark"===N?"#232b38":"#fff",color:"dark"===N?"#fff":"#333"}}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ie,{showGifPicker:j,colorMode:N,setShowGifPicker:m,setShowPicker:n,showPicker:g}),(0,M.jsx)(Q,{showPicker:g,showGifPicker:j,colorMode:N,setShowGifPicker:m,postDetails:d,postVideo:v,postFile:h}),(0,M.jsx)(oe,{newMessage:i,typingHandler:s,placeholder:"Type a message"})]}),(0,M.jsx)(ne,{newMessage:i,pic:a,audio:x,gif:b,video:C,colorMode:N,sendMessageButton:r,picLoading:l,audioLoading:p,videoLoading:w,fileLoading:S,setIsAudioRecording:z,isRecording:F,onStop:_,isAudioRecording:R,setIsRecording:I})]})})]})})},de=(0,a.lazy)((function(){return n.e(616).then(n.bind(n,616))})),le=function(e){var t=e.colorMode,n=e.setSelectedChat,r=e.message,i=e.user,s=e.fetchMessages,c=e.deleteChat,d=e.fetchAgain,l=e.setFetchAgain,u=e.selectedChat,h=e.pic,x=e.audio,p=e.gif,f=e.video,g=e.file,m=e.showPicker,j=e.loading,b=e.isTyping,v=e.deleteMessage,C=e.showGifPicker,k=e.setGifHandler,S=e.newMessage,y=e.sendMessageButton,F=e.sendMessage,I=e.setShowPicker,R=e.typingHandler,z=e.postDetails,N=e.picLoading,Z=e.setPic,_=e.postAudio,A=e.audioLoading,P=e.videoLoading,B=e.fileLoading,L=e.setAudio,O=e.setShowGifPicker,G=e.setGif,E=e.postVideo,D=e.setVideo,q=e.onEmojiClick,V=e.setFile,U=e.postFile,T=e.star,W=e.setStar,Y=e.isRecording,J=e.setIsRecording,K=e.isAudioRecording,Q=e.setIsAudioRecording,$=h||f||g||p;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H,{colorMode:t,setSelectedChat:n,message:r,user:i,fetchMessages:s,deleteChat:c,fetchAgain:d,setFetchAgain:l,selectedChat:u,isPreview:$,setPic:Z,setAudio:L,setVideo:D,setFile:V,setGif:G}),h||p||f||g||m?(0,M.jsx)(M.Fragment,{}):(0,M.jsx)(o.xu,{d:"flex",flexDir:"column",justifyContent:"flex-end",paddingInline:3,w:"100%",h:"100%",borderRadius:m?"0.5rem 0.5rem 0 0":"3xl",overflowY:"hidden",bg:"dark"===t?"#2d3748":"white",children:j?(0,M.jsxs)(o.xu,{d:"flex",flexDir:"column",justifyContent:"center",alignItems:"center",h:"100%",w:"100%",children:[(0,M.jsx)(w(),{size:30,color:"dark"===t?"#efeff1":"#1a202c"}),(0,M.jsx)(o.xv,{fontFamily:"nunito",mt:20,children:"It's Taking time because You Have More high Resolution Images or Very Long Messages"})]}):(0,M.jsx)(o.xu,{className:"messages",bg:"dark"===t?"#2d3748":"white",children:(0,M.jsx)(a.Suspense,{fallback:(0,M.jsx)(M.Fragment,{}),children:(0,M.jsx)(de,{message:r,selectedChat:u,isTyping:b,deleteMessage:v,star:T,setStar:W})})})}),(0,M.jsx)(ce,{newMessage:S,sendMessageButton:y,sendMessage:F,setShowPicker:I,typingHandler:R,postDetails:z,pic:h,picLoading:N,setPic:Z,postAudio:_,audio:x,audioLoading:A,videoLoading:P,fileLoading:B,setAudio:L,showPicker:m,setShowGifPicker:O,showGifPicker:C,gif:p,setGif:G,postVideo:E,video:f,setVideo:D,onEmojiClick:q,file:g,setFile:V,postFile:U,setGifHandler:k,isRecording:Y,setIsRecording:J,isAudioRecording:K,setIsAudioRecording:Q})]})},ue=function(e){var t=e.fetchAgain,n=e.setFetchAgain,h=(0,a.useState)([]),f=(0,s.Z)(h,2),v=f[0],w=f[1],C=(0,a.useState)(!1),k=(0,s.Z)(C,2),S=k[0],y=k[1],F=(0,a.useState)(""),I=(0,s.Z)(F,2),R=I[0],z=I[1],N=(0,a.useState)(!1),Z=(0,s.Z)(N,2),_=Z[0],A=Z[1],P=(0,a.useState)(!1),B=(0,s.Z)(P,2),L=B[0],O=B[1],G=(0,a.useState)(!1),E=(0,s.Z)(G,2),D=E[0],H=E[1],q=(0,a.useState)(!1),V=(0,s.Z)(q,2),U=V[0],T=V[1],W=(0,a.useState)(!1),Y=(0,s.Z)(W,2),J=Y[0],K=Y[1],Q=(0,a.useState)(""),$=(0,s.Z)(Q,2),X=$[0],ee=$[1],te=(0,a.useState)(!1),ne=(0,s.Z)(te,2),re=ne[0],ie=(ne[1],(0,a.useState)("")),se=(0,s.Z)(ie,2),oe=se[0],ae=se[1],ce=(0,a.useState)(!1),de=(0,s.Z)(ce,2),ue=de[0],he=de[1],xe=(0,a.useState)(""),pe=(0,s.Z)(xe,2),fe=pe[0],ge=pe[1],me=(0,a.useState)(),je=(0,s.Z)(me,2),be=je[0],ve=je[1],we=(0,a.useState)(!1),Ce=(0,s.Z)(we,2),ke=Ce[0],Se=Ce[1],ye=(0,a.useState)(!1),Fe=(0,s.Z)(ye,2),Ie=Fe[0],Re=Fe[1],ze=(0,a.useState)(""),Ne=(0,s.Z)(ze,2),Ze=Ne[0],_e=Ne[1],Ae=(0,a.useState)(!1),Me=(0,s.Z)(Ae,2),Pe=Me[0],Be=Me[1],Le=(0,a.useState)(!1),Oe=(0,s.Z)(Le,2),Ge=Oe[0],Ee=Oe[1],De=(0,a.useState)(""),He=(0,s.Z)(De,2),qe=He[0],Ve=He[1],Ue=new Audio("https://firebasestorage.googleapis.com/v0/b/storage-1a7bb.appspot.com/o/files%2Fimessage_send_sound%20(1).mp3?alt=media&token=6a7cf28e-d678-406a-9473-b1a6b4751cff"),Te=(0,p.pm)(),We=(0,c.If)().colorMode,Ye=(0,d.g)(),Je=Ye.user,Ke=Ye.selectedChat,Qe=Ye.setSelectedChat,$e=Ye.setNotification,Xe=Ye.notification,et=function(){var e=(0,u.Z)(x().mark((function e(){var t,n,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ke){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(Je.token)}},y(!0),e.next=7,g().get("/api/message/".concat(Ke._id),t);case 7:n=e.sent,i=n.data,w(i),y(!1),r.emit("join chat",Ke._id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),Te({title:"Error Occurred!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){(r=(0,j.ZP)("https://chatdapp-mern.herokuapp.com")).emit("setup",Je),r.on("connected",(function(){return A(!0)})),r.on("typing",(function(){return H(!0)})),r.on("stop typing",(function(){return H(!1)}))}),[]),(0,a.useEffect)((function(){et(),i=Ke}),[Ke]),(0,a.useEffect)((function(){r.on("message received",(function(e){i&&i._id===e.chat._id?w([].concat((0,l.Z)(v),[e])):Xe.includes(e)||($e([e].concat((0,l.Z)(Xe))),n(!t))}))}));var tt=function(){var e=(0,u.Z)(x().mark((function e(t){var n,i,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==t.keyCode||""===R.trim()||!(R||oe||fe||X||Ze)){e.next=23;break}return r.emit("stop typing",Ke._id),e.prev=2,n={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(Je.token)}},e.next=6,g().post("api/message",{content:R,image:oe,audio:fe,file:qe,chatId:Ke._id,gif:X,video:Ze,star:Ge},n);case 6:i=e.sent,s=i.data,r.emit("new message",s),z(""),T(!1),ae(""),ge(""),ee(""),_e(""),Ve(""),Ue.play(),w([].concat((0,l.Z)(v),[s])),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),Te({title:"Error Occurred!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 23:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(t){return e.apply(this,arguments)}}(),nt=function(){var e=(0,u.Z)(x().mark((function e(){var t,n,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(R&&""!==R.trim()||oe||fe||X||Ze)){e.next=23;break}return r.emit("stop typing",Ke._id),e.prev=2,t={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(Je.token)}},e.next=6,g().post("api/message",{content:R,image:oe,file:qe,audio:fe,chatId:Ke._id,gif:X,video:Ze},t);case 6:n=e.sent,i=n.data,r.emit("new message",i),z(""),T(!1),ae(""),ge(""),ee(""),_e(""),Ve(""),Ue.play(),w([].concat((0,l.Z)(v),[i])),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),Te({title:"Error Occurred!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 23:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}(),rt=function(){var e=(0,u.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{Authorization:"Bearer ".concat(Je.token)}},e.next=4,g().put("/api/message/messages",{_id:t._id},n);case 4:r=e.sent,r.data,et(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Te({title:"Error Occurred!",description:"Failed to Delete the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=(0,u.Z)(x().mark((function e(){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe(),e.prev=1,r={headers:{Authorization:"Bearer ".concat(Je.token)}},e.next=5,g().put("/api/chat/remove",{_id:Ke._id},r);case 5:i=e.sent,i.data,n(!t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Te({title:"Error Occurred!",description:"Failed to Delete the Chat",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return(0,M.jsx)(M.Fragment,{children:Ke?(0,M.jsx)(le,{colorMode:We,setSelectedChat:Qe,message:v,user:Je,fetchMessages:et,deleteChat:it,fetchAgain:t,setFetchAgain:n,selectedChat:Ke,pic:oe,audio:fe,gif:X,video:Ze,file:qe,showPicker:U,loading:S,isTyping:D,deleteMessage:rt,showGifPicker:J,setGifHandler:function(e){ee(e),K(!1),T(!1)},newMessage:R,sendMessageButton:nt,sendMessage:tt,setShowPicker:T,typingHandler:function(e){if(z(e),_){L||(O(!0),r.emit("typing",Ke._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=3e3&&L&&(r.emit("stop typing",Ke._id),O(!1))}),3e3)}},postDetails:function(e){if(e.type.match("image.*")){var t=new FileReader;t.addEventListener("load",(function(){ae(t.result)}),!1),e&&t.readAsDataURL(e)}else alert("Please select image only.")},picLoading:re,setPic:ae,postAudio:function(e){he(!0);var t=new FormData;t.append("file",e),t.append("upload_preset","chat-app-mern"),t.append("cloud_name","yuvraj-choudahry-dev"),fetch("https://api.cloudinary.com/v1_1/yuvraj-choudahry-dev/video/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){ge(e.url.toString()),console.log(e.url.toString()),he(!1)})).catch((function(e){he(!1)}))},audioLoading:ue,videoLoading:Ie,fileLoading:Pe,setAudio:ge,setShowGifPicker:K,setGif:ee,postVideo:function(e){Re(!0);var t=new FormData;t.append("file",e),t.append("upload_preset","chat-app-mern"),t.append("cloud_name","yuvraj-choudahry-dev"),fetch("https://api.cloudinary.com/v1_1/yuvraj-choudahry-dev/video/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){_e(e.url.toString()),console.log(e.url.toString()),Re(!1)})).catch((function(e){Re(!1)}))},setVideo:_e,onEmojiClick:function(e){if(z((function(t){return t+e})),_){L||(O(!0),r.emit("typing",Ke._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=1e3&&L&&(r.emit("stop typing",Ke._id),O(!1))}),1e3)}},setFile:Ve,postFile:function(e){if(Be(!0),e)if("image/*"!==e.type||"video/*"!==e.type){var t=(0,m.iH)(b.tO,"/files/".concat(e.name)),n=(0,m.B0)(t,e);n.on("state_changed",(function(e){}),(function(e){console.log(e),Be(!1)}),(function(){(0,m.Jt)(n.snapshot.ref).then((function(e){console.log(e),Ve(e),Be(!1)}))}))}else Be(!1)},star:Ge,setStar:Ee,isRecording:be,setIsRecording:ve,isAudioRecording:ke,setIsAudioRecording:Se}):(0,M.jsx)(o.xu,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:(0,M.jsx)(o.xv,{fontSize:"3xl",pb:3,fontFamily:"Nunito",children:"Click on a user or a group to start chating"})})})},he=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=e.isHidden,i=(e.setIsHidden,(0,d.g)().selectedChat),s=(0,c.If)().colorMode;return(0,M.jsx)(o.xu,{d:{base:i?"flex":"none",xl:"flex"},alignItems:"center",flexDir:"column",overflow:"hidden",p:3,bg:"dark"===s?"#2d3748":"white",w:{base:"100%",xl:"70%"},h:{base:i&&"100vh",xl:r?"calc(100vh - 24px)":"100%"},children:(0,M.jsx)(ue,{fetchAgain:t,setFetchAgain:n})})},xe=function(e){var t=e.getSender,n=e.loggedUser,r=e.setSelectedChat,i=e.chat,s=e.selectedChat,a=e.colorMode,c=e.getSenderPic;return(0,M.jsxs)(o.xu,{onClick:function(){return r(i)},bg:s===i?"#38B2AC":"dark"===a?"#232b38":"#E8E8E8",color:s===i||"dark"===a?"white":"black",px:3,py:2,borderRadius:"xl",boxShadow:"inner",className:"transition-all duration-500 ease-in-out drop-shadow-lg hover:shadow-2xl",_hover:{color:"white",bg:"#38B2AC"},children:[(0,M.jsxs)(o.xv,{fontFamily:"Nunito",fontSize:18,alignItems:"center",d:"flex",children:[(0,M.jsx)(y.qE,{name:i.isGroupChat?i.chatName:t(n,i.users),src:i.isGroupChat?i.pic:c(n,i.users),width:10,height:10,mr:2}),i.isGroupChat?i.chatName:t(n,i.users)]}),i.latestMessage&&(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(o.xv,{fontSize:"xs",fontWeight:"hairline",fontFamily:"Nunito",children:[(0,M.jsxs)("b",{children:[i.latestMessage.sender.name,": "]}),i.latestMessage.content.length>50?i.latestMessage.content.substring(0,51)+"...":i.latestMessage.content]})})]},i._id)},pe=function(e){var t=e.searchChat,n=e.getSender,r=e.loggedUser,i=e.setSelectedChat,s=e.selectedChat,a=e.colorMode,c=e.getSenderPic,d=e.chats;return(0,M.jsx)(o.Kq,{overflowY:"scroll",w:"100%",h:"100vh",paddingInline:"15px",children:d.filter((function(e){return""===t||(e.isGroupChat?e.chatName.toLowerCase().includes(t.toLowerCase()):n(r,e.users).toLowerCase().includes(t.toLowerCase()))?e:void 0})).map((function(e){return(0,M.jsx)(xe,{getSender:n,loggedUser:r,setSelectedChat:i,chat:e,selectedChat:s,colorMode:a,getSenderPic:c})}))})},fe=n(7718),ge=function(){return(0,M.jsxs)(o.Kq,{paddingInline:"15px",children:[(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"}),(0,M.jsx)(fe.Od,{height:"45px",borderRadius:"xl",boxShadow:"inner",className:"drop-shadow-lg"})]})},me=function(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:"",children:(0,M.jsx)("path",{fill:"currentColor",d:"M19.005 3.175H4.674C3.642 3.175 3 3.789 3 4.821V21.02l3.544-3.514h12.461c1.033 0 2.064-1.06 2.064-2.093V4.821c-.001-1.032-1.032-1.646-2.064-1.646zm-4.989 9.869H7.041V11.1h6.975v1.944zm3-4H7.041V7.1h9.975v1.944z"})})},je=function(e){var t=e.children,n=(0,_.qY)(),r=n.isOpen,i=n.onOpen,c=n.onClose,h=(0,a.useState)(),f=(0,s.Z)(h,2),m=f[0],j=f[1],b=(0,a.useState)([]),v=(0,s.Z)(b,2),w=v[0],C=v[1],k=(0,a.useState)(""),y=(0,s.Z)(k,2),F=y[0],I=y[1],R=(0,a.useState)([]),z=(0,s.Z)(R,2),N=z[0],Z=z[1],P=(0,a.useState)(!1),D=(0,s.Z)(P,2),H=D[0],q=D[1],V=(0,a.useState)(!1),U=(0,s.Z)(V,2),T=(U[0],U[1]),W=(0,a.useState)(),Y=(0,s.Z)(W,2),J=Y[0],K=Y[1],Q=(0,p.pm)(),$=(0,d.g)(),X=$.user,ee=$.chats,te=$.setChats,ne=function(){var e=(0,u.Z)(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,q(!0),n={headers:{Authorization:"Bearer ".concat(X.token)}},e.next=8,g().get("/api/user?search=".concat(F),n);case 8:r=e.sent,i=r.data,q(!1),Z(i),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),Q({title:"Failed to Create the Chat!",description:e.t0.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,u.Z)(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m&&w){e.next=3;break}return Q({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"}),e.abrupt("return");case 3:return e.prev=3,t={headers:{Authorization:"Bearer ".concat(X.token)}},e.next=7,g().post("/api/chat/group",{name:m,pic:J,users:JSON.stringify(w.map((function(e){return e._id})))},t);case 7:n=e.sent,r=n.data,te([r].concat((0,l.Z)(ee))),c(),Q({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),Q({title:"Failed to Create the Chat!",description:e.t0.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("span",{onClick:i,children:t}),(0,M.jsxs)(A.u_,{size:"3xl",isOpen:r,onClose:c,isCentered:!0,motionPreset:"slideInBottom",children:[(0,M.jsx)(A.ZA,{bg:"none",backdropFilter:"auto",backdropBlur:"5px"}),(0,M.jsxs)(A.hz,{minHeight:"450px",children:[(0,M.jsx)(A.xB,{fontSize:"35px",fontFamily:"Nunito",d:"flex",justifyContent:"center",children:"Create Group Chat"}),(0,M.jsx)(A.ol,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsxs)(A.fe,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"center",children:[(0,M.jsx)(B.NI,{children:(0,M.jsx)(L.II,{placeholder:"Chat Name",mb:3,onChange:function(e){return j(e.target.value)}})}),(0,M.jsx)(B.NI,{children:(0,M.jsx)(L.II,{type:"file",p:1.5,accept:"image/*",onChange:function(e){return function(e){if(T(!0),"image/jpeg"===e.type||"image/png"===e.type){var t=new FormData;t.append("file",e),t.append("upload_preset","chat-app-mern"),t.append("cloud_name","yuvraj-choudahry-dev"),fetch("https://api.cloudinary.com/v1_1/yuvraj-choudahry-dev/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){K(e.url.toString()),T(!1)})).catch((function(e){T(!1)}))}else T(!1)}(e.target.files[0])}})}),(0,M.jsx)(B.NI,{children:(0,M.jsx)(L.II,{placeholder:"Add Users eg: yuvraj, gorge, dani, dream",mb:1,onChange:function(e){return ne(e.target.value)}})}),(0,M.jsx)(o.xu,{w:"100%",d:"flex",flexWrap:"wrap",children:w.map((function(e){return(0,M.jsx)(G,{user:e,handleFunction:function(){return function(e){C(w.filter((function(t){return t._id!==e._id})))}(e)}},X._id)}))}),H?(0,M.jsx)(O.$,{ml:"auto",d:"flex"}):null===N||void 0===N?void 0:N.slice(0,4).map((function(e){return(0,M.jsx)(E,{user:e,handleFunction:function(){return t=e,void(w.includes(t)?Q({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):C([].concat((0,l.Z)(w),[t])));var t}},e._id)}))]}),(0,M.jsx)(A.mz,{children:(0,M.jsx)(S.zx,{colorScheme:"blue",onClick:re,children:"Go"})})]})]})]})},be=function(e){var t=e.fetchAgain,n=e.isHidden,r=(e.setIsHidden,(0,a.useState)()),i=(0,s.Z)(r,2),l=i[0],h=i[1],f=(0,d.g)(),m=f.selectedChat,j=f.setSelectedChat,b=f.user,v=f.chats,w=f.setChats,C=(0,c.If)().colorMode,k=(0,a.useState)(""),S=(0,s.Z)(k,2),y=S[0],F=S[1],I=(0,p.pm)(),R=function(){var e=(0,u.Z)(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{Authorization:"Bearer ".concat(b.token)}},e.next=4,g().get("/api/chat",t);case 4:n=e.sent,r=n.data,w(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),I({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){h(JSON.parse(localStorage.getItem("userInfo"))),R()}),[t]),(0,M.jsxs)(o.xu,{d:{base:m?"none":"flex",xl:"flex"},flexDir:"column",alignItems:"center",bg:"white",h:{base:n?"calc(100vh - 24px)":"100%"},w:{base:"100%",xl:"30%"},backgroundColor:"dark"===C?"#2d3748":"#fff",children:[(0,M.jsxs)(o.xu,{pb:2,pt:3,px:"15px",fontSize:{base:"28px",xl:"30px"},fontFamily:"Nunito",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",children:[(0,M.jsx)(L.II,{placeholder:"Search Chats",value:y,onChange:function(e){return F(e.target.value)},borderColor:"rgb(255 255 255 / 0%)"}),(0,M.jsx)(je,{children:(0,M.jsx)(Y.Z,{style:{marginLeft:7,color:"#898787"},children:(0,M.jsx)(me,{})})})]}),(0,M.jsx)(o.xu,{d:"flex",flexDir:"column",pt:3,w:"100%",h:"100vh",borderRadius:"3xl",overflowY:"hidden",children:v?(0,M.jsx)(pe,{searchChat:y,chats:v,getSender:Z.j2,loggedUser:l,setSelectedChat:j,selectedChat:m,colorMode:C,getSenderPic:Z.dJ}):(0,M.jsx)(ge,{})})]})},ve=n(1070),we=n(4930),Ce=function(){return(0,M.jsx)(o.xu,{fontSize:"lg",m:1,children:(0,M.jsx)("svg",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",viewBox:"0 0 512 512","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:(0,M.jsx)("path",{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})})},ke=function(e){var t=e.children,n=(0,_.qY)(),r=n.isOpen,i=n.onOpen,s=n.onClose;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("span",{onClick:i,children:t}),(0,M.jsxs)(A.u_,{size:"3xl",isOpen:r,onClose:s,isCentered:!0,motionPreset:"slideInBottom",children:[(0,M.jsx)(A.ZA,{bg:"none",backdropFilter:"auto",backdropBlur:"5px"}),(0,M.jsxs)(A.hz,{minHeight:"450px",children:[(0,M.jsx)(A.xB,{fontSize:"40px",fontFamily:"Nunito",d:"flex",justifyContent:"center"}),(0,M.jsx)(A.ol,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsxs)(A.fe,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[(0,M.jsxs)(o.xv,{fontSize:{base:"28px",md:"30px"},fontFamily:"Nunito",children:["Created By :"," ",(0,M.jsx)("a",{href:"https://www.github.com/Yuvraj-choudhary",target:"_blank",children:"Yuvraj Choudhary \ud83d\ude1c"}),","]}),(0,M.jsxs)(o.xv,{fontSize:{base:"28px",md:"30px"},fontFamily:"Nunito",children:["Coded By :"," ",(0,M.jsx)("a",{href:"https://www.github.com/Yuvraj-choudhary",target:"_blank",children:"Yuvraj Choudhary \ud83d\ude12"}),","]}),(0,M.jsxs)(o.xv,{fontSize:{base:"28px",md:"30px"},fontFamily:"Nunito",children:["Deployed By :"," ",(0,M.jsx)("a",{href:"https://www.github.com/Yuvraj-choudhary",target:"_blank",children:"Yuvraj Choudhary \ud83d\ude09"})]})]}),(0,M.jsx)(A.mz,{})]})]})]})},Se=function(e){var t=e.children,n=(0,_.qY)(),r=n.isOpen,i=n.onOpen,o=n.onClose,c=(0,a.useState)(""),d=(0,s.Z)(c,2),l=d[0],u=d[1];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("span",{onClick:i,children:t}),(0,M.jsxs)(A.u_,{isCentered:!0,onClose:o,isOpen:r,motionPreset:"slideInBottom",size:"3xl",children:[(0,M.jsx)(A.ZA,{bg:"none",backdropFilter:"auto",backdropBlur:"5px"}),(0,M.jsxs)(A.hz,{children:[(0,M.jsx)(A.xB,{fontSize:"40px",fontFamily:"Nunito",d:"flex",justifyContent:"center",children:"Search The Web"}),(0,M.jsx)(A.ol,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsx)(A.fe,{children:(0,M.jsxs)(B.NI,{isRequired:!0,d:"flex",children:[(0,M.jsx)(L.II,{placeholder:"Search The Web",onChange:function(e){return u(e.target.value)}}),l?(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("a",{href:"https://www.google.com/search?q=".concat(l),target:"_blank",children:(0,M.jsx)(S.zx,{variant:"solid",colorScheme:"teal",ml:2,children:"Go"})})}):(0,M.jsx)(S.zx,{variant:"solid",colorScheme:"teal",ml:"10px",disabled:!0,children:"Go"})]})}),(0,M.jsx)(A.mz,{})]})]})]})},ye=function(e){var t=e.isHidden,n=e.setIsHidden,r=(0,a.useState)(""),i=(0,s.Z)(r,2),h=i[0],f=i[1],m=(0,a.useState)([]),j=(0,s.Z)(m,2),b=j[0],v=j[1],w=(0,a.useState)(!1),k=(0,s.Z)(w,2),I=k[0],R=k[1],z=(0,a.useState)(!1),B=(0,s.Z)(z,2),G=B[0],D=B[1],H=(0,_.qY)(),q=H.isOpen,V=H.onOpen,U=H.onClose,T=(0,d.g)(),W=T.user,Y=T.setSelectedChat,J=T.chats,K=T.setChats,Q=T.setNotification,$=T.notification,X=T.selectedChat,ee=(0,N.k6)(),te=(0,p.pm)(),ne=(0,c.If)(),re=ne.colorMode,ie=ne.toggleColorMode,se=function(){localStorage.removeItem("userInfo"),ee.push("/")},oe=function(){var e=(0,u.Z)(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=3;break}return te({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"}),e.abrupt("return");case 3:return e.prev=3,R(!0),t={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=8,g().get("/api/user?search=".concat(h),t);case 8:n=e.sent,r=n.data,R(!1),v(r),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),te({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,u.Z)(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D(!0),n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(W.token)}},e.next=5,g().post("/api/chat",{userId:t},n);case 5:r=e.sent,i=r.data,J.find((function(e){return e._id===i._id}))||K([i].concat((0,l.Z)(J))),Y(i),D(!1),U(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),te({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}();return(0,M.jsx)(M.Fragment,{children:t?(0,M.jsx)(o.xu,{d:{base:X?"none":"flex",xl:"flex"},justifyContent:"center",onClick:function(){n(!1)},children:(0,M.jsx)(C.v4,{fontSize:25,cursor:"pointer"})}):(0,M.jsxs)(o.xu,{d:t?"none":"flex",children:[(0,M.jsxs)(o.xu,{justifyContent:"space-between",alignItems:"center",bg:"dark"===re?"#2d3748":"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px",borderColor:"dark"===re?"#232b38":"#e5e7eb",d:{base:X?"none":"flex",xl:"flex"},children:[(0,M.jsxs)(o.xu,{d:"flex",children:[(0,M.jsx)(ve.u,{label:"Search Users to chats",hasArrow:!0,placement:"bottom-end",children:(0,M.jsxs)(S.zx,{variant:"",onClick:V,mr:2,d:"flex",alignItems:"center",children:[(0,M.jsx)(C.GV,{}),(0,M.jsx)(o.xv,{fontFamily:"Nunito",fontWeight:"medium",d:{base:"none",md:"initial"},pl:"3",pt:"0.5",children:"Search Users"})]})}),(0,M.jsx)(S.hU,{"aria-label":"hi",icon:(0,M.jsx)(C.g8,{fontSize:"2xl"}),variant:"",isRound:!0,onClick:function(){n(!0)}})]}),(0,M.jsx)(ke,{children:(0,M.jsx)(S.zx,{fontSize:"2xl",fontWeight:"bold",fontFamily:"Nunito",d:{base:"none",md:"flex"},variant:"",children:"Chat Dapp"})}),(0,M.jsxs)(o.xu,{children:[(0,M.jsx)(S.hU,{onClick:function(){return ie()},"aria-label":"mode",mr:2,variant:"",isRound:!0,children:"dark"===re?(0,M.jsx)(C.NW,{fontSize:"xl",m:1}):(0,M.jsx)(Ce,{})}),(0,M.jsxs)(F.v2,{children:[(0,M.jsxs)(F.j2,{p:1,as:S.hU,mr:2,variant:"",isRound:!0,children:[(0,M.jsx)(we.ZP,{count:$.length,effect:we.Qm.SCALE}),(0,M.jsx)(C.Dk,{fontSize:"2xl",m:1})]}),(0,M.jsxs)(F.qy,{p:2,borderColor:"#d3d3d300",boxShadow:"2xl",borderRadius:"25px",children:[!$.length&&(0,M.jsx)(o.xv,{fontFamily:"Nunito",p:3,fontSize:18,children:"No New Messages"}),$.map((function(e){return(0,M.jsx)(F.sN,{onClick:function(){Y(e.chat),Q($.filter((function(t){return t!==e})))},children:(0,M.jsx)(o.xv,{fontFamily:"Nunito",p:3,fontSize:18,children:e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New Message from ".concat((0,Z.j2)(W,e.chat.users))})},e._id)}))]})]}),(0,M.jsxs)(F.v2,{children:[(0,M.jsx)(F.j2,{as:S.zx,rightIcon:(0,M.jsx)(C.v4,{}),variant:"",isRound:!0,children:(0,M.jsx)(o.xu,{display:"flex",alignItems:"center",children:(0,M.jsx)(y.qE,{size:"sm",cursor:"pointer",name:W.name,src:W.pic})})}),(0,M.jsxs)(F.qy,{borderColor:"#d3d3d300",borderRadius:"33px",boxShadow:"2xl",children:[(0,M.jsx)(F.sN,{borderRadius:"24px 24px 0 0",children:(0,M.jsx)(P,{user:W,children:"My Profile"})}),(0,M.jsx)(F.R,{}),(0,M.jsx)(F.sN,{children:(0,M.jsx)(o.xv,{p:2,fontSize:18,onClick:se,fontFamily:"Nunito",children:"Logout"})}),(0,M.jsx)(F.R,{}),(0,M.jsx)(F.sN,{borderRadius:"0 0 24px 24px",children:(0,M.jsx)(Se,{children:(0,M.jsx)(o.xv,{p:2,fontSize:18,onClick:se,fontFamily:"Nunito",children:"Search Web"})})})]})]})]})]}),(0,M.jsxs)(A.dy,{isOpen:q,placement:"left",onClose:U,size:"xl",children:[(0,M.jsx)(A.P1,{bg:"none",backdropFilter:"auto",backdropBlur:"6px"}),(0,M.jsxs)(A.sc,{children:[(0,M.jsx)(A.cC,{borderRadius:"50%",fontSize:"15px",variant:""}),(0,M.jsx)(A.OX,{borderBottomWidth:"1px",borderColor:"rgb(255 255 255 / 0%)",children:"Search Users"}),(0,M.jsxs)(A.Ng,{children:[(0,M.jsxs)(o.xu,{d:"flex",pb:2,children:[(0,M.jsx)(L.II,{placeholder:"Search by name or email",mr:2,value:h,onChange:function(e){return f(e.target.value)},borderColor:"rgb(255 255 255 / 0%)"}),(0,M.jsx)(S.zx,{variant:"",onClick:oe,children:"Go"})]}),I?(0,M.jsx)(ge,{}):null===b||void 0===b?void 0:b.map((function(e){return(0,M.jsx)(E,{user:e,handleFunction:function(){return ae(e._id)}},e._id)})),G&&(0,M.jsx)(O.$,{ml:"auto",d:"flex"})]})]})]})]})})},Fe=(n(4905),function(){var e=(0,d.g)().user,t=(0,a.useState)(!1),n=(0,s.Z)(t,2),r=n[0],i=n[1],c=(0,a.useState)(!1),l=(0,s.Z)(c,2),u=l[0],h=l[1];return(0,M.jsxs)(o.xu,{style:{width:"100%"},overflow:"hidden",className:"chat-anim",children:[e&&(0,M.jsx)(ye,{isHidden:u,setIsHidden:h}),(0,M.jsxs)(o.xu,{d:"flex",justifyContent:"space-between",w:"100%",className:"chat-box",children:[e&&(0,M.jsx)(be,{fetchAgain:r,isHidden:u,setIsHidden:h}),e&&(0,M.jsx)(he,{fetchAgain:r,setFetchAgain:i,isHidden:u,setIsHidden:h})]})]})})},1724:function(){},4905:function(){}}]);
//# sourceMappingURL=371.2118cd4e.chunk.js.map